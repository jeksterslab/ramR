---
title: "Reticular Action Model (RAM) Notation"
author: "Ivan Jacob Agaloos Pesigan"
date: "`r Sys.Date()`"
description: >
  Learn how to get started with the basics of `ramR`.
output:
  rmarkdown::html_vignette:
    toc: true
vignette: >
  %\VignetteIndexEntry{Reticular Action Model (RAM) Notation}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

<!-- badges: start -->
[![R build status](https://github.com/jeksterslab/ramR/workflows/R-CMD-check/badge.svg?branch=master)](https://github.com/jeksterslab/ramR/actions?workflow=R-CMD-check)
[![Travis build status](https://travis-ci.com/jeksterslab/ramR.svg?branch=master)](https://travis-ci.com/jeksterslab/ramR)
[![codecov](https://codecov.io/github/jeksterslab/ramR/branch/master/graphs/badge.svg)](https://codecov.io/github/jeksterslab/ramR) 
<!-- badges: end -->

## Description

A collection of utility functions using the Reticular Action Model (RAM) notation.

## Installation

You can install the released version of `ramR` from [GitHub](https://github.com/jeksterslab/ramR) with:

```r
remotes::install_github("jeksterslab/ramR")
```

## Example

Let $y$, $m$, $x$, $\varepsilon_y$, and $\varepsilon_m$ be random variables
whose associations are given by

\begin{equation}
  y = \beta_0 + \beta_1 x + \beta_2 m + \varepsilon_y
\end{equation}

\begin{equation}
  m = \alpha_0 + \alpha_1 x + \varepsilon_m
\end{equation}

or combined

\begin{equation}
  \begin{split}
    y
    &=
    \beta_0
    + \beta_1 x
    + \beta_2 (\alpha_0 + \alpha_1 x + \varepsilon_m)
    + \varepsilon_y \\
    &=
    \beta_0
    + \beta_1 x
    + \beta_2 \alpha_0
    + \alpha_1 \beta_2 x
    + \beta_2 \varepsilon_m
    + \varepsilon_y
  \end{split}
\end{equation}

where

- $\beta_1$ is the path from $x$ on $y$
- $\beta_2$ is the path from $m$ to $y$
- $\alpha_1$ is the path from $x$ to $m$
- $\varepsilon_y$ and $\varepsilon_m$ are uncorrelated error terms
  with means of zero and constant variances of $\sigma_{\varepsilon_y}^{2}$ and
  $\sigma_{\varepsilon_m}^{2}$ respectively
- $\beta_0$ and $\alpha_0$ are intercepts

### Equations to RAM

The `ramR::eq2ram` converts structural equations to RAM notation.

#### Symbolic

The simple mediation model
can be expressed in the following equations

```{r}
eq_sym <- "
  # VARIABLE1 OPERATION VARIABLE2 LABEL
  ey          by        y         1
  em          by        m         1
  y           on        x         beta[1]
  y           on        m         beta[2]
  m           on        x         alpha[1]
  ey          with      ey        sigma[varepsilon[y]]^2
  em          with      em        sigma[varepsilon[m]]^2
  x           with      x         sigma[x]^2
  y           on        1         beta[0]
  m           on        1         alpha[0]
  x           on        1         mu[x]
"
```

```{r}
ram <- ramR::eq2ram(eq_sym)
ram
```

```{r, echo=FALSE, results = "asis"}
cat(
  "\\begin{equation*}",
  "\\mathbf{A} =",
  Ryacas::tex(Ryacas::ysym(ram$A)),
  "\\end{equation*}",
  sep = ""
)
```

```{r, echo=FALSE, results = "asis"}
cat(
  "\\begin{equation*}",
  "\\mathbf{S} =",
  Ryacas::tex(Ryacas::ysym(ram$S)),
  "\\end{equation*}",
  sep = ""
)
```

```{r, echo=FALSE, results = "asis"}
cat(
  "\\begin{equation*}",
  "\\mathbf{F} =",
  Ryacas::tex(Ryacas::ysym(ram$filter)),
  "\\end{equation*}",
  sep = ""
)
```

```{r, echo=FALSE, results = "asis"}
cat(
  "\\begin{equation*}",
  "\\mathbf{u} =",
  Ryacas::tex(Ryacas::ysym(ram$u)),
  "\\end{equation*}",
  sep = ""
)
```

#### Numerical

Matrices of the RAM notation can be derived numerically
by supplying values to the parameters.

```{r}
eq_num <- "
  # VARIABLE1 OPERATION VARIABLE2 VALUE
  ey          by        y         1
  em          by        m         1
  y           on        x         0.00
  y           on        m         0.50
  m           on        x         0.50
  ey          with      ey        168.75
  em          with      em        168.75
  x           with      x         225
  y           on        1         50
  m           on        1         50
  x           on        1         100
"
```

```{r}
ramR::eq2ram(eq_num)
```

### Equations to Expectations

The `ramR` package has a utility function
to convert structural equations to expectations
both symbolically and numerically.

#### Symbolic

```{r}
exp <- ramR::eq2exp_sym(eq_sym)
exp
```

```{r, echo=FALSE, results = "asis"}
cat(
  "\\begin{equation*}",
  "\\mathbf{C} =",
  Ryacas::tex(exp$C),
  "\\end{equation*}",
  sep = ""
)
```

```{r, echo=FALSE, results = "asis"}
cat(
  "\\begin{equation*}",
  "\\mathbf{M} =",
  Ryacas::tex(exp$M),
  "\\end{equation*}",
  sep = ""
)
```

```{r, echo=FALSE, results = "asis"}
cat(
  "\\begin{equation*}",
  "\\mathbf{v} =",
  Ryacas::tex(exp$v),
  "\\end{equation*}",
  sep = ""
)
```

```{r, echo=FALSE, results = "asis"}
cat(
  "\\begin{equation*}",
  "\\mathbf{g} =",
  Ryacas::tex(exp$g),
  "\\end{equation*}",
  sep = ""
)
```

#### Numerical

```{r}
ramR::eq2exp_num(eq_num)
```

## More Information

See [GitHub Pages](https://jeksterslab.github.io/ramR/index.html)
for package documentation.
See [ramR_notes](https://jeksterslab.github.io/ramR_notes/index.html)
for notes and more examples.
